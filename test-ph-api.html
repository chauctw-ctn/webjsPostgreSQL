<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test pH API</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
        }
        pre {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>Test pH API</h1>
    
    <button onclick="testPHFilter()">Test pH Filter</button>
    <button onclick="testAllFilter()">Test All Filter</button>
    
    <h2>Result:</h2>
    <div id="result"></div>
    
    <script>
        async function testPHFilter() {
            const stationIds = [
                'tva_NHÀ_MÁY_SỐ_1_-_GIẾNG_SỐ_1',
                'tva_NHÀ_MÁY_SỐ_1_-_GIẾNG_SỐ_3',
                'tva_NHÀ_MÁY_SỐ_2_-_GIẾNG_SỐ_2',
                'tva_NHÀ_MÁY_SỐ_2_-_GIẾNG_SỐ_3',
                'tva_QT1-NM1_(2186/GP-BTNMT)',
                'tva_QT2-NM1_(2186/GP-BTNMT)',
                'tva_QT3_(182/GP-BTNMT)',
                'tva_TRẠM_BƠM_12',
                'tva_TRẠM_BƠM_16',
                'tva_TRẠM_BƠM_2',
                'tva_TRẠM_BƠM_20',
                'tva_TRẠM_BƠM_21',
                'tva_TRẠM_BƠM_22',
                'tva_TRẠM_BƠM_23',
                'tva_TRẠM_BƠM_24',
                'tva_TRẠM_BƠM_25',
                'tva_TRẠM_BƠM_26',
                'tva_TRẠM_BƠM_27',
                'tva_TRẠM_BƠM_4',
                'scada_G4_NM2',
                'scada_G5_NM1',
                'scada_G4_NM1',
                'scada_TRAM_1',
                'scada_TRAM_24'
            ];
            
            const params = new URLSearchParams({
                stations: stationIds.join(','),
                type: 'all',
                parameter: 'pH',
                startDate: '2026-02-04',
                endDate: '2026-02-04',
                limit: 50000
            });
            
            const url = `/api/stats?${params}`;
            console.log('Testing pH filter:', url);
            
            try {
                const response = await fetch(url);
                const result = await response.json();
                
                console.log('pH Filter Result:', result);
                document.getElementById('result').innerHTML = `
                    <h3>pH Filter Result</h3>
                    <p><strong>Success:</strong> ${result.success}</p>
                    <p><strong>Records:</strong> ${result.data?.length || 0}</p>
                    <pre>${JSON.stringify(result, null, 2)}</pre>
                `;
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('result').innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        }
        
        async function testAllFilter() {
            const stationIds = [
                'scada_G4_NM2',
                'scada_G5_NM1',
                'scada_G4_NM1',
                'scada_TRAM_1',
                'scada_TRAM_24'
            ];
            
            const params = new URLSearchParams({
                stations: stationIds.join(','),
                type: 'all',
                parameter: 'all',
                startDate: '2026-02-04',
                endDate: '2026-02-04',
                limit: 50000
            });
            
            const url = `/api/stats?${params}`;
            console.log('Testing all filter:', url);
            
            try {
                const response = await fetch(url);
                const result = await response.json();
                
                console.log('All Filter Result:', result);
                document.getElementById('result').innerHTML = `
                    <h3>All Filter Result (SCADA only)</h3>
                    <p><strong>Success:</strong> ${result.success}</p>
                    <p><strong>Records:</strong> ${result.data?.length || 0}</p>
                    <pre>${JSON.stringify(result, null, 2)}</pre>
                `;
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('result').innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>
